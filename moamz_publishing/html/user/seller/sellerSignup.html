<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>sellerSignup</title>
  <link rel="stylesheet" href="../../../static/css/reset2.css">
  <link rel="stylesheet" href="../../../static/css/user/seller/sellerSignup.css">
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
</head>
<body>
  <div id="signup-container">

    <div id="signup-logo">
      <img src="../../../static/img/user/logo-green.jpg">
    </div>
    <div id="signup-user"><strong>판매자 회원가입</strong></div>
    
    <form action="" method="post">
      <div id="singup-profile">
        <!-- 이미지 클릭시 첨부파일 이동! -->
        <!--lable을 누르면 input 태그로 연결-->
        <label for="attach">
          <div class="image">
            <!-- <img src="../../../static/img/user/loginprofile.jpg"> -->
          </div>
        </label>
        <div class="cancle"></div>
        <input type="file" id="attach" style="display: none;">
      </div>
      
      <div id="signup-wrap">
        <div id="signup-email">
          <input type="email" id="email-input" placeholder="이메일을 입력해주세요">
          <button id="email-btn">중복확인</button>
          <!-- <input type="button" id="email-btn" placeholder="중복확인"> -->
          <input id="password-input" type="password" placeholder="비밀번호 입력(영문, 숫자, 특수문자 포함8~20)">
          <input id="password-recheck" type="password" placeholder="비밀번호 재확인">
          <!-- js 비밀번호 형식, 비밀번호 재확인 -->
          <p id="check-p"></p>
          <p id="recheck-p"></p>
        </div>
        <div id="signup-phone">
          <input id="name-input" type="password" placeholder="이름">
          <input type="email" id="input-phone" placeholder="휴대폰번호">
          <button id="phone-btn">중복확인</button>
          <input type="email" id="recheck-phone" placeholder="인증번호">
          <span id="time"></span>
          <button id="recheck-btn">확인</button>
        </div>
        <div id="signup-post"> 
          <h2>업체주소</h2>
          <input type="text" id="post-input" placeholder=" 우편번호" readonly>
          <button id="post-btn">중복확인</button>
          <input type="text" id="address" placeholder=" 도로명 주소" readonly>
          <input type="text" id="detail-address" placeholder= "상세주소">
        </div>
        <div id="signup-business"> 
          <input type="text" id="business-input" placeholder="사업자번호">
          <button id="business-btn">중복확인</button>
          <input type="text" id="business-name" placeholder="업체명">
          <input type="text" id="business-phone" placeholder= "업체 전화번호">
        </div>

        <div id="signup-agreement">
          <!-- 이용약관동의 모달 만들기 -->
          <div id="info-check">
            <input type="checkbox" id="info-click">개인정보 수집 및 이용 약관
          </div>
        </div>
        <div id="signup-box">
          <button id="signup-but"><p>회원가입</p></button>
        </div>
      </div>

    </form> 
  </div>
</body>
<script>
  const input = document.getElementById("attach");
  const thumnail = document.querySelector("div.image");
  const cancle = document.querySelector("div.cancle");

  //업로드한 파일 정보가 input 태그의 value에 들어간다.
  //파일이 업로드 될 때 value가 변화된다.
  //따라서 클릭이벤트를 주게 되면, 업로드 되기 전에 실행되기 때문에 change가 적합하다.
  input.addEventListener("change", (e) => {
      //console.log(e.target.files);
      
      //비구조화 할당
      //업로드된 파일을 가져온다
      //e.target.files는 FileList 자료형이다.
      const [file] = e.target.files;

      const reader = new FileReader();    //업로드된 파일을 읽을 수 있는 FileReader 객체
      reader.readAsDataURL(file);    //파일의 내용이 아니라 절대경로를 읽겠다는 의미
      
      //경로를 읽어오는 방식이 stream 방식이다.
      //reader객체가 파일을 다 읽어왔다면 load 이벤트를 발생시킨다.
      //이 이벤트가 발생했ㅇ르 때 reader 객체는 인코딩된 절대경로를 가진다.
      reader.addEventListener("load", (e) => { 
          //x 버튼이 보이도록 함
          cancle.style.display = "block";

          //base64로 인코딩된 경로를 src()에 담아주면 해당 경로의 이미지를 출력한다.
          if(e.target.result.includes("image")) {
              thumnail.style.backgroundImage = `url("${e.target.result}")`;
              //x 버튼이 보여야 하는 곳

          } else {
              thumnail.style.backgroundImage = `url("./")`;
          }
          
      })
  })


  //cancle 버튼이 눌리면
  cancle.addEventListener("click", (e) => {

      //1. 맨 처음 이미지로 변경
      thumnail.style.backgroundImage = "url('./a.png')";

      //2. input 태그의 value 초기화해주기
      input.value="";

      //3. X 버튼 숨기기
      cancle.style.display = "none";
  })
//--------------------------------------------------------
$(function(){
    $('#password-input').keyup(function(){
      $('#recheck-p').html('');
    });

    $('#password-recheck').keyup(function(){

        if($('#password-input').val() != $('#password-recheck').val()){
          $('#recheck-p').html('•비밀번호 일치하지 않음<br><br>');
          $('#recheck-p').attr('color', '#ff0000');
        } else{
          $('#recheck-p').html('•비밀번호 일치함<br><br>');
          $('#recheck-p').attr('color', '#008000');
        }

    });
});

//-----------------------------------------------------------
var pw = $("password-input").val();
var reg = /^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,20}$/;
var hangulcheck = /[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/;
$(function(){
    $('#password-input').keyup(function(){
      $('#recheck-p').html('');
    });

    $('#password-recheck').keyup(function(){

        if(false === reg.test(pw)){
          $('#check-p').html('•비밀번호는 8자 이상 20자 이하 하며, 숫자/대문자/소문자/특수문자를 모두 포함해야 합니다.<br><br>');
          $('#check-p').attr('color', '#ff0000');
        } else if(pw.search(/\s/) != -1){
          $('#check-p').html('•비밀번호는 공백 없이 입력해주세요.<br><br>');
          $('#check-p').attr('color', '#008000');
        } else if(hangulcheck.test(pw)){
          $('#check-p').html('•비밀번호에 한글을 사용 할 수 없습니다.<br><br>');
          $('#check-p').attr('color', '#008000');
        } else{
          console("통과");
        }

    });
});

//-----------------------------------------------------------

$(document).ready(function() {
    let seconds; // 남은 시간 변수
    let countdown; // 카운트다운을 관리하는 변수
    const $timeSpan = $('#time'); // 시간을 표시할 요소
    const $btnSend = $('#phone-btn'); // "인증번호 받기" 버튼 요소

    // 시간을 업데이트하고 화면에 표시하는 함수
    const updateCountdown = function() {
        if (seconds >= 0) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            $timeSpan.text(`${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`);
            seconds--;
        } else {
            clearInterval(countdown);
            alert('인증번호 유효시간이 만료되었습니다.');
        }
    };

    // "인증번호 받기" 버튼 클릭 이벤트 핸들러
    $btnSend.on('click', function(e) {
        e.preventDefault();
        $btnSend.text('재전송');
        alert('인증번호가 발송되었습니다.');

        clearInterval(countdown);
        seconds = 180; // 3분(180초)

        updateCountdown();
        // 1초마다 카운트다운 업데이트
        countdown = setInterval(updateCountdown, 1000); 
    });
});

    $(function() {
        $("#header").load("../../main/fragment/header/userHeaderLogin.html");
        $("#footer").load("../../main/fragment/footer/userFooter.html");
    });     

</script>
</html>